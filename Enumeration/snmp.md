# SNMP Enumeration (Simple Network Management Protocol)

> The Simple Network Management Protocol (SNMP) is a protocol used in TCP/IP networks to collect and manage information about networked devices. SNMP operates in the application layer (layer 7 of the OSI model) and uses UDP port 161 to listen for requests. The SNMP protocol is supported by many types of devices including routers, switches, servers, printers, Network Attached Storage (NAS), firewalls, WLAN controllers and more.

- Basic enumeration
```
snmp-check 10.10.10.161
snmpwalk -c public -v 1 conceal.htb
```

- SNMP is using UDP not TCP

-  Fix SNMP output values so they are human readable

```
apt-get install snmp-mibs-downloader download-mibs
echo "" > /etc/snmp/snmp.conf
```

## Scanning for SNMP

-  Using nmap

```
nmap -sU -v --open -p 161 192.168.1.12
```

-  Using onesixtyone

```ShellSession
root@kali:~# echo public > /tmp/community.txt
root@kali:~# echo private >> /tmp/community.txt
root@kali:~# echo manager >> /tmp/community.txt
root@kali:~# echo 192.168.1.12 > /tmp/ip.txt
root@kali:~# onesixtyone -c /tmp/community.txt -i /tmp/ip.txt
```

## Windows SNMP Enumeration Example

```ShellSession
root@kali:~# snmpwalk -c puplic -v1 192.168.1.12
```

## SNMP Enumeration Commands

```ShellSession
snmpcheck -t $ip -c public

snmpwalk -c public -v1 $ip 1|

grep hrSWRunName|cut -d\* \* -f

snmpenum -t $ip

onesixtyone -c names -i hosts
```

## SNMPv3 Enumeration

```ShellSession
nmap -sV -p 161 --script=snmp-info $ip/24
```

## Automate the username enumeration process for SNMPv3:

```ShellSession
apt-get install snmp snmp-mibs-downloader
wget https://raw.githubusercontent.com/raesene/TestingScripts/master/snmpv3enum.rb
```

## SNMP Default Credentials

```
/usr/share/metasploit-framework/data/wordlists/snmp\_default\_pass.tx
```
## snmpwalk
```
#enumerating MIB tree
 snmpwalk -c public -v1 -t 10 10.11.1.14 

# Enumerating Windows Users 
  snmpwalk -c public -v1 10.11.1.14 1.3.6.1.4.1.77.1.2.25 
  
# Enumerating Running Windows Processes 
  snmpwalk -c public -v1 10.11.1.73 1.3.6.1.2.1.25.4.2.1.2 
  
# Enumerating Open TCP Ports 
  snmpwalk -c public -v1 10.11.1.14 1.3.6.1.2.1.6.13.1.3 
 
# Enumerating Installed Software 
  snmpwalk -c public -v1 10.11.1.50 1.3.6.1.2.1.25.6.3.1.2 
 ```